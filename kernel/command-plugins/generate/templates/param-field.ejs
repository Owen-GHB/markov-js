<!-- File: command-plugins/generate/templates/param-field.ejs -->
<% if (param.type.includes('blob')) { %>
<div class="form-field blob-field">
  <label for="<%= param.name %>">
    <%= param.description %>
    <% if (param.required) { %><span class="required">*</span><% } %>
  </label>
  
  <input 
    type="file" 
    id="<%= param.name %>" 
    name="<%= param.name %>"
    class="file-input"
    <% if (param.required) { %>required<% } %>
    <% if (param.constraints) { %>
      <% if (param.constraints.allowedExtensions) { %>
        accept=".<%= param.constraints.allowedExtensions.join(',.') %>"
      <% } %>
      <% if (param.constraints.allowedTypes) { %>
        data-allowed-types="<%= param.constraints.allowedTypes.join(',') %>"
      <% } %>
      <% if (param.constraints.maxSize) { %>
        data-max-size="<%= param.constraints.maxSize %>"
      <% } %>
    <% } %>
  />
  
  <div class="file-info" id="<%= param.name %>-info" style="display: none;">
    <small>Selected file: <span class="file-name"></span> (<span class="file-size"></span>)</small>
  </div>
  
  <% if (param.constraints) { %>
  <div class="constraints">
    <% if (param.constraints.maxSize) { %>
      <small>Max size: <%= (param.constraints.maxSize / 1024 / 1024).toFixed(1) %> MB</small>
    <% } %>
    <% if (param.constraints.allowedTypes) { %>
      <small>Allowed types: <%= param.constraints.allowedTypes.join(', ') %></small>
    <% } %>
    <% if (param.constraints.allowedExtensions) { %>
      <small>Allowed extensions: .<%= param.constraints.allowedExtensions.join(', .') %></small>
    <% } %>
  </div>
  <% } %>
</div>
<% } else { %>
<!-- Existing field types (string, number, boolean, etc.) -->
<div class="form-field">
  <label for="<%= param.name %>">
    <%= param.description %>
    <% if (param.required) { %><span class="required">*</span><% } %>
  </label>
  
  <% if (param.type.includes('boolean')) { %>
    <input 
      type="checkbox" 
      id="<%= param.name %>" 
      name="<%= param.name %>"
      data-param-name="<%= param.name %>"
      <% if (defaultValue) { %>checked<% } %>
    />
  <% } else if (param.enum) { %>
    <select id="<%= param.name %>" name="<%= param.name %>" data-param-name="<%= param.name %>" <% if (param.required) { %>required<% } %>>
      <% if (!param.required) { %>
        <option value="">-- Select --</option>
      <% } %>
      <% param.enum.forEach(value => { %>
        <option value="<%= value %>" <% if (defaultValue === value) { %>selected<% } %>>
          <%= value %>
        </option>
      <% }); %>
    </select>
  <% } else if (param.type.includes('array')) { %>
    <!-- ARRAY FIELD - Display as comma-separated, not JSON -->
    <textarea 
      id="<%= param.name %>" 
      name="<%= param.name %>"
      data-param-name="<%= param.name %>"
      placeholder="Enter comma-separated values"
      <% if (param.required) { %>required<% } %>
      rows="3"
    ><%= 
      // Convert array to comma-separated string for display
      Array.isArray(defaultValue) ? 
        defaultValue.map(item => String(item)).join(', ') : 
        (defaultValue ? String(defaultValue) : '')
    %></textarea>
    <small class="json-hint">Enter comma-separated values</small>
  <% } else if (param.type.includes('object')) { %>
    <textarea 
      id="<%= param.name %>" 
      name="<%= param.name %>"
      data-param-name="<%= param.name %>"
      placeholder="Enter JSON"
      <% if (param.required) { %>required<% } %>
      rows="3"
    ><%= defaultValue ? JSON.stringify(defaultValue, null, 2) : '' %></textarea>
    <small class="json-hint">Enter valid JSON</small>
  <% } else { %>
    <input 
      type="<% 
        if (param.type.includes('integer') || param.type.includes('number')) { 
          %>number<%
        } else if (param.type.includes('password')) { 
          %>password<%
        } else { 
          %>text<%
        } 
      %>" 
      id="<%= param.name %>" 
      name="<%= param.name %>"
      data-param-name="<%= param.name %>"
      <% if (defaultValue !== undefined) { %>value="<%= defaultValue %>"<% } %>
      <% if (param.required) { %>required<% } %>
      <% if (param.min !== undefined) { %>min="<%= param.min %>"<% } %>
      <% if (param.max !== undefined) { %>max="<%= param.max %>"<% } %>
      placeholder="<%= param.description %>"
    />
  <% } %>
</div>
<% } %>